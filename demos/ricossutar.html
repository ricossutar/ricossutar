<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="utf-8">
  <title>RiccoSSUtar</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">
  <link rel="shortcut icon" href="/demos/logo.png">
  <link rel="stylesheet" href="/demos/room_style.css">
  <!-- <link rel="stylesheet" href="/demos/stylesheet.css"> -->
  <script src="/demos/menu.js"></script>
</head>
<body>
    <div class="nav">
        <a style='width:fit-content; height:fit-content;' href="/">
			<svg class='logo' xmlns="http://www.w3.org/2000/svg" viewBox="0 0 207.26 39.43"><defs><style>.cls-1{fill:#97ff00;}.cls-2{fill:#231815;}.cls-5{fill:#fff;}</style></defs><g id="레이어_2" data-name="레이어 2"><g id="레이어_1-2" data-name="레이어 1"><path class="cls-1" d="M1,37.83V11.75H8.06l.27,2.68a8.38,8.38,0,0,1,6.27-3.28,7.75,7.75,0,0,1,3.22.59l.76.31-1.5,7.36L16,19.08a6.69,6.69,0,0,0-2.2-.34c-.88,0-3.08.38-4.54,3.92V37.83Z"/><path class="cls-2" d="M14.6,12.15a6.86,6.86,0,0,1,2.84.51l-1.12,5.46a7.86,7.86,0,0,0-2.5-.38c-1.89,0-4.17,1.24-5.54,4.73V36.83H2V12.75H7.16L7.59,17h.17c1.76-3.14,4.34-4.86,6.84-4.86m0-2a8.69,8.69,0,0,0-5.48,2.1L9,10.75H0V38.83H10.28v-16c.86-2,2.17-3.13,3.54-3.13a5.67,5.67,0,0,1,1.9.29l2.11.67.45-2.17,1.12-5.46.33-1.62-1.53-.64a8.83,8.83,0,0,0-3.6-.66Z"/><path class="cls-1" d="M19.1,37.83V11.75h8.28V37.83ZM23.28,9.88A4.52,4.52,0,0,1,18.5,5.44,4.47,4.47,0,0,1,23.28,1,4.45,4.45,0,0,1,28,5.44,4.5,4.5,0,0,1,23.28,9.88Z"/><path class="cls-2" d="M23.28,2A3.46,3.46,0,0,1,27,5.44a3.51,3.51,0,0,1-3.75,3.44A3.51,3.51,0,0,1,19.5,5.44,3.46,3.46,0,0,1,23.28,2m3.1,10.75V36.83H20.1V12.75h6.28M23.28,0A5.42,5.42,0,0,0,22,10.75H18.1V38.83H28.38V10.75H24.59A5.42,5.42,0,0,0,23.28,0Z"/><path class="cls-1" d="M42.76,38.43C35.14,38.43,30,33,30,24.83c0-9,6.69-13.68,13.3-13.68A11.59,11.59,0,0,1,51,14.05l.71.61-4.2,5.7-.82-.7a4.48,4.48,0,0,0-3.05-1.35c-3.13,0-5.15,2.56-5.15,6.52s2,6.44,5,6.44a6.56,6.56,0,0,0,4-1.7l.89-.75,3.53,5.89-.63.55A13,13,0,0,1,42.76,38.43Z"/><path class="cls-2" d="M43.32,12.15a10.54,10.54,0,0,1,7,2.66l-3,4.09a5.49,5.49,0,0,0-3.7-1.59c-3.65,0-6.15,3-6.15,7.52s2.5,7.44,6,7.44a7.54,7.54,0,0,0,4.69-1.93l2.49,4.17a11.94,11.94,0,0,1-7.87,2.92C36.1,37.43,31,32.79,31,24.83s5.77-12.68,12.3-12.68m0-2c-7.1,0-14.3,5-14.3,14.68,0,8.6,5.65,14.6,13.74,14.6A14,14,0,0,0,52,36l1.24-1.1-.85-1.42-2.5-4.17-1.2-2-1.8,1.5a5.51,5.51,0,0,1-3.4,1.47c-2.42,0-4-2.13-4-5.44,0-2.67,1.09-5.52,4.15-5.52A3.49,3.49,0,0,1,46,20.42l1.63,1.4,1.28-1.73,3-4.09,1.11-1.5-1.42-1.21a12.55,12.55,0,0,0-8.31-3.14Z"/><path class="cls-1" d="M63.32,38.43c-6.25,0-12.57-4.67-12.57-13.6s6.32-13.68,12.57-13.68,12.56,4.7,12.56,13.68S69.56,38.43,63.32,38.43Zm0-20.12c-3.82,0-4.12,5-4.12,6.52s.3,6.44,4.12,6.44,4.11-4.93,4.11-6.44S67.14,18.31,63.32,18.31Z"/><path class="cls-2" d="M63.32,12.15c6,0,11.56,4.64,11.56,12.68s-5.54,12.6-11.56,12.6-11.57-4.64-11.57-12.6S57.3,12.15,63.32,12.15m0,20.12c3.26,0,5.11-2.92,5.11-7.44s-1.85-7.52-5.11-7.52-5.12,3-5.12,7.52,1.85,7.44,5.12,7.44m0-22.12c-6.74,0-13.57,5-13.57,14.68s7,14.6,13.57,14.6,13.56-5.11,13.56-14.6S70.06,10.15,63.32,10.15Zm0,20.12c-2.82,0-3.12-3.8-3.12-5.44s.3-5.52,3.12-5.52,3.11,3.86,3.11,5.52-.3,5.44-3.11,5.44Z"/><path class="cls-5" d="M86.19,38.43a16.22,16.22,0,0,1-9.8-3.63l-.71-.6,4-5.55.81.64a9.44,9.44,0,0,0,5.83,2.41c2.49,0,2.49-1.16,2.49-1.54,0-1-1.95-1.73-3.83-2.46l-.57-.22c-2-.74-7.21-2.74-7.21-7.94,0-4.94,4.09-8.39,9.94-8.39A14.41,14.41,0,0,1,96,14.31l.8.6-4,5.41-.8-.56c-1.88-1.32-3.27-1.88-4.63-1.88s-2.18.44-2.18,1.32,1.67,1.48,3.43,2.12l.82.3c2.76,1,7.36,2.78,7.36,8.2C96.78,34.11,93.51,38.43,86.19,38.43Z"/><path class="cls-2" d="M87.18,12.15a13.48,13.48,0,0,1,8.21,3l-2.83,3.83a9.3,9.3,0,0,0-5.21-2.06c-2.15,0-3.18.94-3.18,2.32,0,1.76,2.37,2.41,4.9,3.35,3.19,1.21,6.71,2.8,6.71,7.27,0,4.21-3.31,7.61-9.59,7.61A15.19,15.19,0,0,1,77,34l2.89-4a10.4,10.4,0,0,0,6.44,2.62c2.41,0,3.49-1,3.49-2.54,0-1.8-2.5-2.62-5-3.61-3.06-1.16-6.58-3-6.58-7,0-4.34,3.52-7.39,8.94-7.39m0-2c-6.44,0-10.94,3.86-10.94,9.39,0,5.89,5.71,8.06,7.87,8.88l.55.21a11.32,11.32,0,0,1,3.19,1.58c0,.33-.54.49-1.49.49a8.54,8.54,0,0,1-5.21-2.2l-1.63-1.27L78.3,28.9l-2.88,4-1.1,1.51,1.43,1.2a17.06,17.06,0,0,0,10.44,3.86c8,0,11.59-4.83,11.59-9.61,0-6.11-5.2-8.08-8-9.14l-.83-.3a11.28,11.28,0,0,1-2.77-1.25v0a2.28,2.28,0,0,1,1.17-.21,7.3,7.3,0,0,1,4.06,1.7L93,21.7l1.16-1.57L97,16.31l1.19-1.61-1.6-1.19a15.43,15.43,0,0,0-9.41-3.36Z"/><path class="cls-5" d="M106.83,38.43A16.22,16.22,0,0,1,97,34.8l-.72-.6,4-5.55.82.64A9.44,9.44,0,0,0,107,31.7c2.49,0,2.49-1.16,2.49-1.54,0-1-1.95-1.73-3.84-2.46l-.56-.22c-2-.74-7.21-2.74-7.21-7.94,0-4.94,4.09-8.39,9.94-8.39a14.41,14.41,0,0,1,8.81,3.16l.8.6-4,5.41-.8-.56c-1.88-1.32-3.27-1.88-4.63-1.88s-2.18.44-2.18,1.32,1.67,1.48,3.43,2.12l.82.3c2.76,1,7.36,2.78,7.36,8.2C117.42,34.11,114.15,38.43,106.83,38.43Z"/><path class="cls-2" d="M107.82,12.15a13.48,13.48,0,0,1,8.21,3l-2.83,3.83A9.3,9.3,0,0,0,108,16.88c-2.15,0-3.18.94-3.18,2.32,0,1.76,2.37,2.41,4.9,3.35,3.19,1.21,6.71,2.8,6.71,7.27,0,4.21-3.31,7.61-9.59,7.61A15.19,15.19,0,0,1,97.67,34l2.88-4A10.45,10.45,0,0,0,107,32.7c2.41,0,3.49-1,3.49-2.54,0-1.8-2.5-2.62-5-3.61-3.06-1.16-6.58-3-6.58-7,0-4.34,3.52-7.39,8.94-7.39m0-2c-6.44,0-10.94,3.86-10.94,9.39,0,5.89,5.71,8.06,7.87,8.88l.55.21c1.07.42,2.85,1.11,3.18,1.58,0,.33-.53.49-1.48.49a8.58,8.58,0,0,1-5.22-2.2l-1.63-1.27L98.94,28.9l-2.88,4L95,34.37l1.43,1.2a17.06,17.06,0,0,0,10.44,3.86c8,0,11.59-4.83,11.59-9.61,0-6.11-5.2-8.08-8-9.14l-.84-.3a11.36,11.36,0,0,1-2.76-1.25v0a2.28,2.28,0,0,1,1.17-.21,7.3,7.3,0,0,1,4.06,1.7l1.59,1.12,1.16-1.57,2.84-3.82,1.19-1.61-1.6-1.19a15.43,15.43,0,0,0-9.41-3.36Z"/><path class="cls-5" d="M127.73,38.43c-3.83,0-8.4-1.84-8.4-10.63v-16h8.33V27c0,3.74,1,4,2.35,4,1.51,0,2.52-.6,3.9-2.35V11.75h8.32V37.83h-7l-.33-2.38A10.06,10.06,0,0,1,127.73,38.43Z"/><path class="cls-2" d="M141.23,12.75V36.83h-5.16l-.47-3.44h-.17c-2.07,2.45-4.39,4-7.7,4-5.16,0-7.4-3.61-7.4-9.63v-15h6.33V27c0,3.74,1,5,3.35,5,2,0,3.27-.86,4.9-3V12.75h6.32m2-2H132.91V28.31C131.73,29.74,131,30,130,30c-.76,0-1.35,0-1.35-3V10.75H118.33V27.8c0,10.12,5.89,11.63,9.4,11.63a10.69,10.69,0,0,0,6.4-2.06l.2,1.46h8.9V10.75Z"/><path class="cls-1" d="M156.15,38.43c-4.06,0-8.91-1.74-8.91-10V18.74h-3.4V12.13l3.8-.31.74-6.52h7.18v6.45h5.94v7h-5.94V28.4c0,2.68,1.09,3,2.27,3a6.17,6.17,0,0,0,2-.44l1.09-.44,1.49,6.63-.86.29A16.45,16.45,0,0,1,156.15,38.43Z"/><path class="cls-2" d="M154.56,6.3v6.45h5.94v5h-5.94V28.4c0,2.75,1.12,4,3.27,4a7.06,7.06,0,0,0,2.37-.51l1,4.6a15.59,15.59,0,0,1-5.08.9c-5.72,0-7.91-3.61-7.91-9V17.74h-3.4V13.05l3.7-.3.73-6.45h5.29m2-2h-9.07l-.2,1.77-.55,4.82-2.06.17-1.84.15v8.53h3.4V28.4c0,7.11,3.52,11,9.91,11a17.89,17.89,0,0,0,5.71-1l1.71-.57-.39-1.77-1-4.6-.52-2.29-2.18.87a5,5,0,0,1-1.62.37c-.65,0-1.27,0-1.27-2V19.74h5.94v-9h-5.94V4.3Z"/><path class="cls-1" d="M170.7,38.43a7.87,7.87,0,0,1-8.14-8.14c0-7,7.15-9,13.75-9.78-.28-1.59-1.22-2.29-3-2.29a12.77,12.77,0,0,0-6.12,2.15l-.89.51L163.09,15l.8-.5a20.08,20.08,0,0,1,10.59-3.33c6.61,0,10.25,4.12,10.25,11.62V37.83h-7L177.39,36A11.2,11.2,0,0,1,170.7,38.43Zm5.71-12c-5.83,1-5.83,2.75-5.83,3.36s0,1.71,2.18,1.71a5,5,0,0,0,3.65-1.79Z"/><path class="cls-2" d="M174.48,12.15c6.11,0,9.25,3.65,9.25,10.62V36.83h-5.16l-.48-2.58H178a11.27,11.27,0,0,1-7.26,3.18,6.84,6.84,0,0,1-7.14-7.14c0-5.16,4.17-7.87,13.85-8.9-.09-2.36-1.12-4.17-4.09-4.17-2.24,0-4.38,1-6.62,2.28l-2.28-4.17a19.27,19.27,0,0,1,10.06-3.18m-1.72,20.34c1.81,0,3.14-.86,4.65-2.37V25.26c-5.85.78-7.83,2.37-7.83,4.52,0,1.89,1.33,2.71,3.18,2.71m1.72-22.34a21.09,21.09,0,0,0-11.12,3.48l-1.6,1,.9,1.66,2.28,4.17,1,1.8,1.77-1a12,12,0,0,1,5.62-2,2.06,2.06,0,0,1,1.58.47c-6.63,1-13.34,3.28-13.34,10.6a8.84,8.84,0,0,0,9.14,9.14,11.38,11.38,0,0,0,6-1.78l.22,1.18h8.83V22.77c0-8.14-4-12.62-11.25-12.62Zm-1.72,20.34c-1.18,0-1.18-.35-1.18-.71,0-1.07,2-1.74,3.83-2.15v1.63a3.75,3.75,0,0,1-2.65,1.23Z"/><path class="cls-1" d="M188.53,37.83V11.75h7.07l.27,2.68a8.36,8.36,0,0,1,6.26-3.28,7.75,7.75,0,0,1,3.22.59l.76.31-1.5,7.36-1.06-.33a6.67,6.67,0,0,0-2.19-.34c-.89,0-3.09.38-4.55,3.92V37.83Z"/><path class="cls-2" d="M202.13,12.15a6.86,6.86,0,0,1,2.84.51l-1.12,5.46a7.79,7.79,0,0,0-2.49-.38c-1.9,0-4.17,1.24-5.55,4.73V36.83h-6.28V12.75h5.16l.43,4.26h.17c1.77-3.14,4.35-4.86,6.84-4.86m0-2a8.71,8.71,0,0,0-5.48,2.1l-.15-1.5h-9V38.83h10.28v-16c.86-2,2.17-3.13,3.55-3.13a5.65,5.65,0,0,1,1.89.29l2.11.67.45-2.17,1.12-5.46.33-1.63-1.53-.63a8.83,8.83,0,0,0-3.6-.66Z"/></g></g></svg>
        </a>
    </div> 
    <div class="main_container">
        <div class='flex_container' id="main_room">
            <div class='left_box'>
                <div class='room_container'>
                    <div class='room_button' id="ricossu1">
                        1번방
                    </div>
                    <div class='room_button' id="ricossu2">
                        2번방
                    </div>
                    <div class='room_button' id="ricossu3">
                        3번방
                    </div>
                    <div class='room_button' id="ricossu4">
                        4번방
                    </div>
                    <div class='room_button' id="ricossu5">
                        5번방
                    </div>
                    <div class='room_button' id="ricossu6">
                        6번방
                    </div>
                    <div class='room_button' id="ricossu7">
                        7번방
                    </div>
                    <div class='room_button' id="ricossu8">
                        8번방
                    </div>
					<div class='room_button' id="ricossu9">
                        9번방
                    </div>
					<div class='room_button' id="ricossu10">
                        10번방
                    </div>
					<div class='room_button' id="ricossu11">
                        11번방
                    </div>
					<div class='room_button' id="ricossu12">
                        12번방
                    </div>
                </div>
            </div>
            <div class='right_box'>
				<svg class='coin_logo' xmlns="http://www.w3.org/2000/svg" viewBox="0 0 102.73 78.19"><defs><style>.cls-1{fill:#97ff00;}.cls-2{fill:#231815;}.cls-3{fill:#f9232a;}</style></defs><g id="레이어_2" data-name="레이어 2"><g id="레이어_1-2" data-name="레이어 1"><path class="cls-1" d="M18.06,33.8V27H28.68v-7.4l-7.41.39-1.07-7,20.22-.66c0-.42,0-.84,0-1.25h-19V4.24H48.13V8.92a68.79,68.79,0,0,1-1.55,16l-.28,1.35-7.71-.95L39,23.64c.38-1.64.68-3.21.88-4.69l-3.43.19V27H51V33.8Z"/><path class="cls-2" d="M46.63,5.74V8.65a68,68,0,0,1-1.51,15.91L40.44,24a49,49,0,0,0,1.11-6.63l-19,1-.61-4,19.9-.64c.11-1.52.11-2.92.11-4.21h-19V5.74H46.63M34.93,20.53v7.92H49.54V32.3h-30V28.45H30.18V20.53h4.75M49.63,2.74H19.94v8.7l-1.48.05L19,14.83l.61,4L20,21.51l2.72-.14,4.47-.24v4.32H16.56V35.3h36V25.45H48l.06-.26A70.31,70.31,0,0,0,49.63,8.92V2.74ZM37.93,20.56h.16c-.05.28-.1.56-.16.84v-.83Z"/><path class="cls-1" d="M56.65,37V23h2.28a9.7,9.7,0,0,1-7.28-9.44c0-5.66,4.53-9.92,10.53-9.92s10.5,4.26,10.5,9.92a9.77,9.77,0,0,1-8.28,9.68v7.07H82.54V37Zm5.53-26.35a2.66,2.66,0,0,0-2.89,2.82,2.67,2.67,0,0,0,2.89,2.78A2.63,2.63,0,0,0,65,13.51,2.61,2.61,0,0,0,62.18,10.69Zm11.75,17.6V1.5h7.79V28.29Z"/><path class="cls-2" d="M80.22,3V26.79H75.43V3h4.79m-18,2.09c5.08,0,9,3.53,9,8.42s-3.92,8.39-9,8.39-9-3.57-9-8.39,4-8.42,9-8.42m0,12.7a4.1,4.1,0,0,0,4.36-4.28,4.09,4.09,0,0,0-4.36-4.32,4.13,4.13,0,0,0-4.39,4.32,4.14,4.14,0,0,0,4.39,4.28m.72,6.66v7.31H81v3.78H58.15V24.45H62.9M83.22,0H72.43V7.39a11.94,11.94,0,0,0-10.25-5.3c-6.86,0-12,4.91-12,11.42a11.12,11.12,0,0,0,5,9.3V38.54H84V28.76h-.82V0Zm-21,14.79c-1.39,0-1.39-1-1.39-1.28s0-1.32,1.39-1.32c1.19,0,1.36.64,1.36,1.32,0,.38,0,1.28-1.36,1.28Zm3.72,9.57a11.75,11.75,0,0,0,6.53-4.84v9.24H65.9v-4.4Z"/><polygon class="cls-3" points="1.5 72.91 1.5 66.06 14.13 66.06 14.13 61.5 4.88 61.5 4.88 42.98 12.63 42.98 12.63 54.72 31.35 54.72 31.35 61.5 21.89 61.5 21.89 66.06 34.52 66.06 34.52 72.91 1.5 72.91"/><path class="cls-2" d="M11.13,44.48V56.22H29.85V60H20.39v7.56H33v3.85H3V67.56H15.63V60H6.38V44.48h4.75m3-3H3.38V63h9.25v1.56H0v9.85H36V64.56H23.39V63h9.46V53.22H14.13V41.48Z"/><path class="cls-3" d="M58.56,76.58V75H51.14V68.51a72.58,72.58,0,0,1-11.78.76H35.52V52.77h7.92V50.48h-8V43.67H51V59.52H43.13v2.82a65.42,65.42,0,0,0,7.49-.69l.52-.08V41h7.42v-.61h7.5V76.58Z"/><path class="cls-2" d="M64.56,41.93V75.08h-4.5V58.27h-3V73.53H52.64v-31h4.43V54.45h3V41.93h4.5M49.51,45.17V58H41.63v5.87a72.14,72.14,0,0,0,9.21-.76L51.2,67a71,71,0,0,1-11.84.79H37V54.27h7.92V49H37V45.17H49.51m18.05-6.24H57.06v.61H49.64v2.63H34V52h0V70.77h5.34a79.73,79.73,0,0,0,10.28-.53v6.29h7.42v1.55h10.5V38.93Z"/><path class="cls-3" d="M84.47,76.69c-7.83,0-12.7-3.06-12.7-8,0-3.87,3-6.59,8.09-7.57H68.71V42.59h7.68v4.1h3.52v-4.1h7.68V60.91c.51.06,1,.14,1.5.23V40.5h7.75v7.7h4.39v6.89H96.84V63H94a6.63,6.63,0,0,1,3.21,5.7C97.2,73.63,92.32,76.69,84.47,76.69Zm0-9.25c-3.43,0-5,.66-5,1.27S81,70,84.47,70s5-.66,5-1.27S87.91,67.44,84.47,67.44Zm-4.56-13v-1.1H76.39v1.1Z"/><path class="cls-2" d="M95.34,42v7.7h4.39v3.89H95.34v7.92H90.59V42h4.75m-9.25,2.09V59.64H70.21V44.09h4.68v4.1h6.52v-4.1h4.68M74.89,55.93h6.52v-4.1H74.89v4.1m9.58,6.3c6.91,0,11.23,2.41,11.23,6.48s-4.32,6.48-11.23,6.48-11.2-2.45-11.2-6.48,4.32-6.48,11.2-6.48m0,9.25c4.24,0,6.51-.9,6.51-2.77s-2.27-2.77-6.51-2.77S78,66.84,78,68.71s2.26,2.77,6.48,2.77M98.34,39H87.59v2.09H78.41v4.1h-.52v-4.1H67.21V62.64H73a8.09,8.09,0,0,0-2.72,6.07c0,4.58,3.73,9.48,14.2,9.48s14.23-4.9,14.23-9.48a8,8,0,0,0-1.17-4.2h.81V56.59h4.39V46.7H98.34V39Z"/></g></g></svg>
                <div id="not_logged" style="width: 100%;">
                    <div id="login_view">
                        <label for="email">이메일</label>
                        <input type="text" id="login_email" name="email" required size="10">
                        <label for="password">비밀번호</label>
                        <input type="password" id="login_password" name="password" required size="10">
                        <a>
                            <button id='login_button'>로그인</button>
                            <button class='change_attr'>회원가입 창으로</button>
                        </a>
                    </div>

                    <div id="register_view", style="display:none">
                        <label for="email">email</label>
                        <input type="text" id="register_email" name="email" required size="10">
                        <label for="name">이름</label>
                        <input type="text" id="register_name" name="name" required size="10">
                        <label for="password">비밀번호</label>
                        <input type="password" id="register_password" name="password" required size="10">
                        <a>
                            <button id='register_button'>회원가입</button>
                            <button class='change_attr'>로그인 창으로</button>
                        </a>
                    </div>
                </div>
                <div id="logged" style="display:none">
                    <div class='username_div'>
                        username_here
                    </div>
                </div>
                
            </div>
        </div>
        <div class='flex_container' id='karaoke_room' style="display:none">
            <div class='left_box'>
                <div id="videos-container" style="margin: 20px 0;"></div>
            </div>
            <div class='right_box' id='room-nav'>
                <img class='coin_logo'src="/demos/coin_logo_thin.png"/>
                <div id='num_container'>
                    번방
                </div>
                <div class='username_div'>
                    username_here
                </div>
                <div id='line'></div>
                <div>예약목록</div>
                <div id="conversation-panel">
                </div>
                <div style="width: 100%; display: flex;">
                    <textarea id="txt-chat-message" placeholder="예약곡을 입력해주세요" onkeypress="onTextChange();"></textarea>
                    <button class="btn btn-primary" id="btn-chat-message" style="width: 50px;">예약</button>
                </div>            
                    <div style="display: none;">
                        <button id='delete'><b>X</b></button><br>
                        <input type="text" id="room-id" value="abcdef" autocorrect=off autocapitalize=off size=20>
                        <button id="open-room">Open Room</button>
                        <button id="join-room">Join Room</button>
                        <button id="open-or-join-room">Auto Open Or Join Room</button> 
                    </div>
                <a href="/">
                    <button id='out_button'>나가기</button>
                </a>
            </div>
        </div>
    </div>

    <div class="footer">
        <br/>
        ⓒ 2021. ricossutar all rights reserved.<br/>
        Soongsil Univ.<br/>
        Project Team Ricossutar 안종훈 이종근 최다인
        <div id="room-urls" style="text-align: center;display: none;background: #F1EDED;margin: 15px -10px;border: 1px solid rgb(189, 189, 189);border-left: 0;border-right: 0;"></div>
  <br><br>
  <label     style="display: none;"><input type="checkbox" id="record-entire-conference"> Record Entire Conference In The Browser?</label>
  <span id="recording-status" style="display: none;"></span>
  <button id="btn-stop-recording" style="display: none;">Stop Recording</button>
        
    </div>
    
<script src="/dist/RTCMultiConnection.min.js"></script>
<script src="/node_modules/webrtc-adapter/out/adapter.js"></script>
<script src="/socket.io/socket.io.js"></script>

<!-- custom layout for HTML5 audio/video elements -->
<link rel="stylesheet" href="/dev/getHTMLMediaElement.css">
<script src="/dev/getHTMLMediaElement.js"></script>

<script src="/node_modules/recordrtc/RecordRTC.js"></script>
<script>

// ......................................................
// .......................UI Code........................
// ......................................................
var is_register = false;

var change_arr = document.getElementsByClassName("change_attr");
for (var i=0; i < change_arr.length; i++) {
    change_arr[i].onclick = function() {
        if(is_register == false){
            is_register = true;
            document.getElementById("login_view").style.display = "none"; 
            document.getElementById("register_view").style.display = "block";
        }
        else{
            is_register = false;
            document.getElementById("login_view").style.display = "block";        
            document.getElementById("register_view").style.display = "none"; 
        }
    }
}
    
function appendChatMessage(received_message) {
    var div = document.createElement('div');
    var conversationPanel = document.getElementById('conversation-panel');
    div.className = 'message';
    div.innerHTML = received_message;
    conversationPanel.appendChild(div);
    conversationPanel.scrollTop = conversationPanel.clientHeight;
    conversationPanel.scrollTop = conversationPanel.scrollHeight - conversationPanel.scrollTop;
}
    
document.getElementById('btn-chat-message').onclick = function() {
    var chatMessage = document.getElementById("txt-chat-message").value
    chatMessage = my_name + " : " + chatMessage
    appendChatMessage(chatMessage);
    connection.send({
        chatMessage: chatMessage,
    });
    document.getElementById("txt-chat-message").value = "";
};

function onTextChange() {
    var key = window.event.keyCode;

    // If the user has pressed enter
    if (key === 13) {
        var chatMessage = document.getElementById("txt-chat-message").value
        chatMessage = my_name + " : " + chatMessage
        appendChatMessage(chatMessage);
        chatMessage = my_name + chatMessage
        connection.send({
            chatMessage: chatMessage,
        });
        document.getElementById("txt-chat-message").value = "";
    }
}    
    
// ......................................................
// ................communicating db Code.................
// ......................................................

var is_logged_in = false;
var my_name = '';

function getCookie(name) {
    let cookieValue = null;
    if (document.cookie && document.cookie !== '') {
        const cookies = document.cookie.split(';');
        for (let i = 0; i < cookies.length; i++) {
            const cookie = cookies[i].trim();
            // Does this cookie string begin with the name we want?
            if (cookie.substring(0, name.length + 1) === (name + '=')) {
                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                break;
            }
        }
    }
    return cookieValue;
}

function sendPost(action, params) {
	var form = document.createElement('form');
	form.setAttribute('method', 'post');
	form.setAttribute('action', action);
	document.charset = "utf-8";
	for ( var key in params) {
		var hiddenField = document.createElement('input');
		hiddenField.setAttribute('type', 'hidden');
		hiddenField.setAttribute('name', key);
		hiddenField.setAttribute('value', params[key]);
		form.appendChild(hiddenField);
	}
	document.body.appendChild(form);
	form.submit(function(event){
        console.log(event);
    });
}

        
login_button.onclick = function(){
    var csrftoken = getCookie('csrftoken');
    fetch('https://rico-db.run.goorm.io/login/', {
        method: 'post',
         body: new URLSearchParams({
                csrftoken: csrftoken,
                email: document.getElementById("login_email").value,
                 password:document.getElementById("login_password").value
                })
            }).then((response) => response.json()).then((data) => {
        if(data.id == null)
            alert('잘못된 정보입니다. 다시 시도해주세요')
        else{
            is_logged_in = true;
            console.log(data)
            my_name = data.name;
            document.getElementById("not_logged").style.display = "none"; 
            document.getElementById("logged").style.display = "block"; 
            var username_arr = document.getElementsByClassName("username_div");
            for (var i=0; i < username_arr.length; i++) {
                username_arr[i].innerText = my_name + "님 환영합니다!"; 
            }
        }
    });
}

register_button.onclick = function(){
    var csrftoken = getCookie('csrftoken');
    fetch('https://rico-db.run.goorm.io/register/', {
         method: 'post',
         body: new URLSearchParams({
                     csrftoken:csrftoken, 
                     email:document.getElementById("register_email").value, 
                     name:document.getElementById("register_name").value,  
                     password:document.getElementById("register_password").value
               })
            }).then((response) => response.json()).then((data) => {
        if(data.id == null)
            alert('잘못된 형식 혹은 이미 존재하는 아이디입니다. 다시 시도해주세요')
        else{
            is_logged_in = true;
            console.log(data)
            my_name = data.name; 
            document.getElementById("not_logged").style.display = "none"; 
            document.getElementById("logged").style.display = "block"; 
            var username_arr = document.getElementsByClassName("username_div");
            for (var i=0; i < username_arr.length; i++) {
                username_arr[i].innerText = my_name + "님 환영합니다!"; 
            }
        }
    });
}


// ......................................................
// ....................connection code...................
// ......................................................

var photo = document.getElementsByClassName("room_button");
var cur_room_num = 0;
for (var i=0; i < photo.length; i++) {
    photo[i].onclick = function() {
        if(is_logged_in == false)
            {
                alert('로그인 후 이용해주세요');
                return;
            }
    document.getElementById("main_room").style.display = "none"; 
    document.getElementById("karaoke_room").style.display = "flex";

    disableInputButtons();
    connection.checkPresence(event.target.id, function(isRoomExist, roomid) {
        if (isRoomExist === true) {
            disableInputButtons();
            connection.join(roomid, function(isJoinedRoom, roomid, error) {
              if (error) {
                    disableInputButtons(true);
                    if(error === 'Room not available') {
                      alert('This room does not exist. Please either create it or wait for moderator to enter in the room.');
                      return;
                    }
                    alert(error);
                }
            });
            
        } else {
            disableInputButtons();
            connection.session.video = false;
            connection.session.screen = true;
            connection.open(roomid, function(isRoomOpened, roomid, error) {
                if(isRoomOpened === true) {
                  showRoomURL(connection.sessionid);
                }
                else {
                  disableInputButtons(true);
                  if(error === 'Room not available') {
                    alert('Someone already created this room. Please either join or create a separate room.');
                    return;
                  }
                  alert(error);
                }
            });
        }
    });        
    cur_room_num = parseInt(event.target.id.substr(7));
    document.getElementById("num_container").innerText = cur_room_num + "번방" ;
    }
};
    
document.getElementById('open-room').onclick = function() {
    disableInputButtons();
    connection.session.video = false;
    connection.session.screen = true;
    connection.open(document.getElementById('room-id').value, function(isRoomOpened, roomid, error) {
        if(isRoomOpened === true) {
          showRoomURL(connection.sessionid);
        }
        else {
          disableInputButtons(true);
          if(error === 'Room not available') {
            alert('Someone already created this room. Please either join or create a separate room.');
            return;
          }
          alert(error);
        }
    });
};

document.getElementById('join-room').onclick = function() {
    disableInputButtons();
    connection.join(document.getElementById('room-id').value, function(isJoinedRoom, roomid, error) {
      if (error) {
            disableInputButtons(true);
            if(error === 'Room not available') {
              alert('This room does not exist. Please either create it or wait for moderator to enter in the room.');
              return;
            }
            alert(error);
        }
    });
};

document.getElementById('open-or-join-room').onclick = function() {
    disableInputButtons();
    connection.openOrJoin(document.getElementById('room-id').value, function(isRoomExist, roomid, error) {
        if(error) {
          disableInputButtons(true);
          alert(error);
        }
        else if (connection.isInitiator === true) {
            // if room doesn't exist, it means that current user will create the room
            showRoomURL(roomid);
        }
    });
};
    
// ......................................................
// ..................RTCMultiConnection Code.............
// ......................................................

var connection = new RTCMultiConnection();

connection.session = {
    audio: true,
    video: true,
    data: true
};


// by default, socket.io server is assumed to be deployed on your own URL
connection.socketURL = '/';

// comment-out below line if you do not have your own socket.io server
// connection.socketURL = 'https://rtcmulticonnection.herokuapp.com:443/';

connection.socketMessageEvent = 'video-conference-demo';

connection.sdpConstraints.mandatory = {
    OfferToReceiveAudio: true,
    OfferToReceiveVideo: true
};

// STAR_FIX_VIDEO_AUTO_PAUSE_ISSUES
// via: https://github.com/muaz-khan/RTCMultiConnection/issues/778#issuecomment-524853468
var bitrates = 512;
var resolutions = 'Ultra-HD';
var videoConstraints = {};

if (resolutions == 'HD') {
    videoConstraints = {
        width: {
            ideal: 1280
        },
        height: {
            ideal: 720
        },
        frameRate: 30
    };
}

if (resolutions == 'Ultra-HD') {
    videoConstraints = {
        width: {
            ideal: 1920
        },
        height: {
            ideal: 1080
        },
        frameRate: 30
    };
}

connection.mediaConstraints = {
    video: videoConstraints,
    audio: true
};

var CodecsHandler = connection.CodecsHandler;

connection.processSdp = function(sdp) {
    var codecs = 'vp8';
    
    if (codecs.length) {
        sdp = CodecsHandler.preferCodec(sdp, codecs.toLowerCase());
    }

    if (resolutions == 'HD') {
        sdp = CodecsHandler.setApplicationSpecificBandwidth(sdp, {
            audio: 128,
            video: bitrates,
            screen: bitrates
        });

        sdp = CodecsHandler.setVideoBitrates(sdp, {
            min: bitrates * 8 * 1024,
            max: bitrates * 8 * 1024,
        });
    }

    if (resolutions == 'Ultra-HD') {
        sdp = CodecsHandler.setApplicationSpecificBandwidth(sdp, {
            audio: 128,
            video: bitrates,
            screen: bitrates
        });

        sdp = CodecsHandler.setVideoBitrates(sdp, {
            min: bitrates * 8 * 1024,
            max: bitrates * 8 * 1024,
        });
    }

    return sdp;
};
// END_FIX_VIDEO_AUTO_PAUSE_ISSUES

// https://www.rtcmulticonnection.org/docs/iceServers/
// use your own TURN-server here!
connection.iceServers = [{
    'urls': [
        'stun:stun.l.google.com:19302',
        'stun:stun1.l.google.com:19302',
        'stun:stun2.l.google.com:19302',
        'stun:stun.l.google.com:19302?transport=udp',
    ]
}];

connection.videosContainer = document.getElementById('videos-container');
connection.onstream = function(event) {
    var existing = document.getElementById(event.streamid);
    if(existing && existing.parentNode) {
      existing.parentNode.removeChild(existing);
    }

    event.mediaElement.removeAttribute('src');
    event.mediaElement.removeAttribute('srcObject');
    event.mediaElement.muted = true;
    event.mediaElement.volume = 0;

    var video = document.createElement('video');

    try {
        video.setAttributeNode(document.createAttribute('autoplay'));
        video.setAttributeNode(document.createAttribute('playsinline'));
    } catch (e) {
        video.setAttribute('autoplay', true);
        video.setAttribute('playsinline', true);
    }

    if(event.type === 'local') {
      video.volume = 0;
      try {
          video.setAttributeNode(document.createAttribute('muted'));
      } catch (e) {
          video.setAttribute('muted', true);
      }
    }
    video.srcObject = event.stream;

    var width = parseInt(connection.videosContainer.clientWidth / 3) - 20;
    var mediaElement = getHTMLMediaElement(video, {
        title: event.userid,
        buttons: ['full-screen'],
        width: width,
        showOnMouseEnter: false
    });

    connection.videosContainer.appendChild(mediaElement);

    setTimeout(function() {
        mediaElement.media.play();
    }, 5000);

    mediaElement.id = event.streamid;

    // to keep room-id in cache
    localStorage.setItem(connection.socketMessageEvent, connection.sessionid);

    chkRecordConference.parentNode.style.display = 'none';

    if(chkRecordConference.checked === true) {
      btnStopRecording.style.display = 'inline-block';
      recordingStatus.style.display = 'inline-block';

      var recorder = connection.recorder;
      if(!recorder) {
        recorder = RecordRTC([event.stream], {
          type: 'video'
        });
        recorder.startRecording();
        connection.recorder = recorder;
      }
      else {
        recorder.getInternalRecorder().addStreams([event.stream]);
      }

      if(!connection.recorder.streams) {
        connection.recorder.streams = [];
      }

      connection.recorder.streams.push(event.stream);
      recordingStatus.innerHTML = 'Recording ' + connection.recorder.streams.length + ' streams';
    }

    if(event.type === 'local') {
      connection.socket.on('disconnect', function() {
        if(!connection.getAllParticipants().length) {
          location.reload();
        }
      });
    }
};

var recordingStatus = document.getElementById('recording-status');
var chkRecordConference = document.getElementById('record-entire-conference');
var btnStopRecording = document.getElementById('btn-stop-recording');
btnStopRecording.onclick = function() {
  var recorder = connection.recorder;
  if(!recorder) return alert('No recorder found.');
  recorder.stopRecording(function() {
    var blob = recorder.getBlob();
    invokeSaveAsDialog(blob);

    connection.recorder = null;
    btnStopRecording.style.display = 'none';
    recordingStatus.style.display = 'none';
    chkRecordConference.parentNode.style.display = 'inline-block';
  });
};

connection.onstreamended = function(event) {
    var mediaElement = document.getElementById(event.streamid);
    if (mediaElement) {
        mediaElement.parentNode.removeChild(mediaElement);
    }
};

connection.onMediaError = function(e) {
    if (e.message === 'Concurrent mic process limit.') {
        if (DetectRTC.audioInputDevices.length <= 1) {
            alert('Please select external microphone. Check github issue number 483.');
            return;
        }

        var secondaryMic = DetectRTC.audioInputDevices[1].deviceId;
        connection.mediaConstraints.audio = {
            deviceId: secondaryMic
        };

        connection.join(connection.sessionid);
    }
};

connection.onmessage = function(event) {
    appendChatMessage(event.data.chatMessage);
};
    

function disableInputButtons(enable) {
    document.getElementById('room-id').onkeyup();

    document.getElementById('open-or-join-room').disabled = !enable;
    document.getElementById('open-room').disabled = !enable;
    document.getElementById('join-room').disabled = !enable;
    document.getElementById('room-id').disabled = !enable;
}

// ......................................................
// ......................Handling Room-ID................
// ......................................................

function showRoomURL(roomid) {
    var roomHashURL = '#' + roomid;
    var roomQueryStringURL = '?roomid=' + roomid;

    var html = '<h2>다음 URL을 공유해서 친구들을 초대해보세요!</h2><br>';

    html += 'Hash URL: <a href="' + roomHashURL + '" target="_blank">' + roomHashURL + '</a>';
    html += '<br>';
    html += 'QueryString URL: <a href="' + roomQueryStringURL + '" target="_blank">' + roomQueryStringURL + '</a>';

    var roomURLsDiv = document.getElementById('room-urls');
    // roomURLsDiv.innerHTML = html;

//     roomURLsDiv.style.display = 'block';
}

(function() {
    var params = {},
        r = /([^&=]+)=?([^&]*)/g;

    function d(s) {
        return decodeURIComponent(s.replace(/\+/g, ' '));
    }
    var match, search = window.location.search;
    while (match = r.exec(search.substring(1)))
        params[d(match[1])] = d(match[2]);
    window.params = params;
})();

var roomid = '';
if (localStorage.getItem(connection.socketMessageEvent)) {
    roomid = localStorage.getItem(connection.socketMessageEvent);
} else {
    roomid = connection.token();
}

var txtRoomId = document.getElementById('room-id');
txtRoomId.value = roomid;
txtRoomId.onkeyup = txtRoomId.oninput = txtRoomId.onpaste = function() {
    localStorage.setItem(connection.socketMessageEvent, document.getElementById('room-id').value);
};

var hashString = location.hash.replace('#', '');
if (hashString.length && hashString.indexOf('comment-') == 0) {
    hashString = '';
}

var roomid = params.roomid;
if (!roomid && hashString.length) {
    roomid = hashString;
}

if (roomid && roomid.length) {
    document.getElementById('room-id').value = roomid;
    localStorage.setItem(connection.socketMessageEvent, roomid);

    // auto-join-room
    (function reCheckRoomPresence() {
        connection.checkPresence(roomid, function(isRoomExist) {
            if (isRoomExist) {
                connection.join(roomid);
                return;
            }

            setTimeout(reCheckRoomPresence, 5000);
        });
    })();

    disableInputButtons();
}

// detect 2G
if(navigator.connection &&
   navigator.connection.type === 'cellular' &&
   navigator.connection.downlinkMax <= 0.115) {
  alert('2G is not supported. Please use a better internet service.');
}
</script>

  <script src="https://www.webrtc-experiment.com/common.js"></script>
</body>
</html>
